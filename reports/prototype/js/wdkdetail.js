var detail;var newId=0;var rowIndex={};var element;function WdksetNewId(lastRowIndex){var id=parseInt(lastRowIndex);if(isNaN(id)){rowIndex=JSON.parse(lastRowIndex)}else{newId=id}}function wdkLoadChild(tablename,skipLoadZoom){var form=$("#Adhocform")[0];if(!form){return}$.each($("input[name^=dtprazoativ___]"),function(i,el){FLUIGC.calendar(el,{minDate:new Date()})});WdkSearchElementsinPage(form,tablename);if($("td.bpm-mobile-column").length){$(".bpm-mobile-expand").last().click()}if(skipLoadZoom!=false&&typeof loadZoomTablename==="function"){loadZoomTablename(tablename)}if(skipLoadZoom!=false&&typeof loadRicheditorTablename==="function"){loadRicheditorTablename(tablename)}}function wdkAddChild(tablename,skipLoadZoom){var id=++rowIndex[tablename];var form=document.getElementsByTagName("form")[0];if(isNaN(id)){newId++}else{newId=id}WdkSearchElementsinPage(form,tablename);if(detail!=null){var nd=detail.cloneNode(true);WdkchangeNames(nd);if(nd.tagName=="TR"){if(navigator.userAgent.indexOf("MSIE 9")!=-1){nd.style.display="block"}else{nd.style.display="table-row"}}else{nd.style.display="inline"}if(nd.id){nd.id=nd.id+"___"+newId}if(detail.parentNode!=null){detail.parentNode.appendChild(nd)}else{var parentNode=document.getElementsByTagName(tablename)[0];if(parentNode!=null){parentNode.appendChild(nd)}else{detail.appendChild(nd)}}}if($("td.bpm-mobile-column").length>0){$(".bpm-mobile-expand").last().click()}if(skipLoadZoom!=false&&typeof loadZoomTablename==="function"){loadZoomTablename(tablename)}if(skipLoadZoom!=false&&typeof loadRicheditorTablename==="function"){loadRicheditorTablename(tablename)}return newId}function WdkSearchElementsinPage(e,tablename){if(detail!=null&&detail.getAttribute("detailname")!=tablename){detail=null}if(detail==null){var y=e.childNodes;for(var i=0;i<y.length;i++){try{var table=y[i].getAttribute("detail");var dname=y[i].getAttribute("detailname");if(table!=null&&dname==tablename){detail=y[i];break}else{WdkSearchElementsinPage(y[i],tablename)}}catch(e){}}}}function WdkchangeNames(e){var nodes=e.childNodes;var name;var value;for(var i=0;i<nodes.length;i++){try{if(nodes[i].getAttribute("name")!=null){if(nodes[i].getAttribute("name").indexOf("___")==-1){element=nodes[i].getAttribute("name");value=nodes[i].getAttribute("value");name=element}else{if(element!=nodes[i].getAttribute("name").substring(0,nodes[i].getAttribute("name").indexOf("___"))){element=nodes[i].getAttribute("name").substring(0,nodes[i].getAttribute("name").indexOf("___"));name=element}else{name=nodes[i].getAttribute("name");value=nodes[i].getAttribute("value")}}}if(name==null){if(nodes[i].getAttribute("id")!=null){if(nodes[i].getAttribute("id").indexOf("___")==-1){element=nodes[i].getAttribute("id");value=nodes[i].getAttribute("value");name=element}else{if(element!=nodes[i].getAttribute("id").substring(0,nodes[i].getAttribute("id").indexOf("___"))){element=nodes[i].getAttribute("id").substring(0,nodes[i].getAttribute("id").indexOf("___"));name=element}else{name=nodes[i].getAttribute("id")}}}}if(name!=null){var ignoreReference=false;if(nodes[i].getAttribute("type")!=null&&(nodes[i].getAttribute("type")=="radio"||nodes[i].getAttribute("type")=="label")){if(name.indexOf("___")!=-1){ignoreReference=true}}if(!ignoreReference&&nodes[i].tagName!=null){var tn=nodes[i].tagName.toLowerCase();var parentClassName=nodes[i].parentNode?nodes[i].parentNode.className:"";if(tn=="label"&&(parentClassName.indexOf("custom-checkbox")!==-1||parentClassName.indexOf("custom-radio")!==-1)){nodes[i].setAttribute("for",name)}if(tn=="div"||tn=="fieldset"||tn=="label"){if(name.indexOf("___")!=-1){ignoreReference=true}}}if(!ignoreReference){name=name+"___"+newId;nodes[i].setAttribute("name",name);nodes[i].setAttribute("id",name)}else{if(nodes[i].getAttribute("name")!=null){var intReference=nodes[i].getAttribute("name").indexOf("___");intReference=intReference+3;var newReference=nodes[i].getAttribute("name").substring(0,intReference);newReference=newReference+newId;nodes[i].setAttribute("name",newReference);nodes[i].setAttribute("id",newReference)}else{if(nodes[i].getAttribute("id")!=null){var intReference=nodes[i].getAttribute("id").indexOf("___");intReference=intReference+3;var newReference=nodes[i].getAttribute("id").substring(0,intReference);newReference=newReference+newId;nodes[i].setAttribute("name",newReference);nodes[i].setAttribute("id",newReference)}}}var type=nodes[i].getAttribute("type");if(type!=null){if(value!=null&&type!="text"){nodes[i].setAttribute("value",value);nodes[i].value=value}else{if(type!="checkbox"){nodes[i].setAttribute("value","");nodes[i].value=""}}}else{nodes[i].setAttribute("value","");nodes[i].value=""}}WdkchangeNames(nodes[i])}catch(e){}}}function fnWdkRemoveChild(element){var form,row=null;var hasRow,hasForm=false;while(element!=null){if(element.id!=null){if(!hasRow&&element.nodeName.toUpperCase()=="TR"){row=element;hasRow=true}else{if(!hasForm&&element.nodeName.toUpperCase()=="FORM"){form=element;hasForm=true}}}element=element.parentNode}var arrayInput=$(row).find("input");$.each(arrayInput,function(index,input){if($(input).prop("readonly")||$(input).prop("disabled")){$.each($(form).find("input[type=hidden]"),function(i,inputHidden){var idInput=$(input).attr("name");var idInputHidden="_"+$(inputHidden).attr("name");if(idInput&&idInputHidden.valueOf()==idInput.valueOf()){$(inputHidden).remove()}})}});$(row).remove()}function restoreCachedRows(formfields,isClearTables){if(typeof isClearTables==="undefined"){isClearTables=false}var organized={};$.each(formfields,function(index,value){if(index.indexOf("___")!=-1){var fieldName=index.substring(0,index.lastIndexOf("___"));var fieldIndex=index.substring(index.lastIndexOf("___")+3);var tablename=$("[name="+fieldName+"]").closest("table[tablename]").attr("tablename");if(tablename==undefined){return}if(organized[tablename]==undefined){organized[tablename]={}}if(organized[tablename][fieldIndex]==undefined){organized[tablename][fieldIndex]={}}organized[tablename][fieldIndex][fieldName]=value}});if(isClearTables){$("table[tablename] tbody tr:visible").remove()}$.each(organized,function(tablename,rows){rowIndex[tablename]=0;$.each(rows,function(tempId,fields){var rowId=wdkAddChild(tablename,false);$.each(fields,function(fieldName,fieldValue){var $field=$("#"+fieldName+"___"+rowId);var type=$field.prop("type").toLowerCase();if(type=="zoom"){var values=fieldValue.split(String.fromCharCode(24));for(var i=0;i<values.length;i++){$("#"+fieldName).append('<option selected value="'+values[i]+'">'+values[i]+"</option>")}}else{$field.val(fieldValue)}})});loadZoomTablename(tablename);loadRicheditorTablename(tablename)})}function clearTables(tablename){$("[tablename="+tablename+"] tbody tr:visible").remove()}function renderRowsTableDetail(formfields,isClearTables){var organized={};var isClearCache=false;var tablenames=$("table[tablename]");if(tablenames&&tablenames.length){$.each(tablenames,function(index,field){var tablename=field.getAttribute("tablename");if(isClearTables&&tablename){clearTables(tablename)}})}var currentHiddenFields=$("input[type=hidden][name*=___]");if(currentHiddenFields.length){$.each(currentHiddenFields,function(i,field){if(field.getAttribute("name")){field.remove()}})}$.each(formfields,function(i,fields){isClearCache=false;$.each(fields,function(index,value){if(index.indexOf("___")!=-1){var fieldName=index.substring(0,index.lastIndexOf("___"));var fieldIndex=index.substring(index.lastIndexOf("___")+3);var tablename=$("[name="+fieldName+"]").closest("table[tablename]").attr("tablename");if(tablename==undefined){return}if(organized[tablename]==undefined){organized[tablename]={}}if(organized[tablename][fieldIndex]==undefined){organized[tablename][fieldIndex]={}}if(organized[tablename][fieldIndex][fieldName]==undefined){organized[tablename][fieldIndex][fieldName]=value}else{organized[tablename][fieldIndex][fieldName]=organized[tablename][fieldIndex][fieldName]+";multiSelect;"+value}}if(isClearTables&&!isClearCache&&tablename){clearTables(tablename);isClearCache=true}})});$.each(organized,function(tablename,rows){rowIndex[tablename]=0;$.each(rows,function(tempId,fields){var rowId=wdkAddChild(tablename,false);$.each(fields,function(fieldName,fieldValue){var $field=$("#"+fieldName+"___"+rowId);var type=$field.prop("type").toLowerCase();if(type=="zoom"){var values=fieldValue.split(String.fromCharCode(24));for(var i=0;i<values.length;i++){$("#"+fieldName).append('<option selected value="'+values[i]+'">'+values[i]+"</option>")}}else{var values=fieldValue.split(";multiSelect;");if(values.length>1){var value="[";for(var i=0;i<values.length;i++){value=value+'"'+values[i]+'",'}fieldValue=value.substr(0,value.length-1)+"]";$field.val(eval(fieldValue))}else{if(type=="checkbox"){$field.prop("checked",true)}else{if(type=="radio"){$("#"+fieldName+"___"+rowId+"[value='"+fieldValue+"']").prop("checked",true)}else{$field.val(fieldValue)}}}}})});loadZoomTablename(tablename);loadRicheditorTablename(tablename)})};